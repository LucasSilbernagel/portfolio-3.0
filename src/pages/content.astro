---
const STRAPI_ADMIN_URL = import.meta.env.PUBLIC_STRAPI_ADMIN_URL
const REDIRECT_DELAY_MS = 100
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Redirecting to Content Management...</title>
  </head>
  <body>
    <div id="redirect-data" data-strapi-url={STRAPI_ADMIN_URL}></div>
    <script define:vars={{ redirectDelay: REDIRECT_DELAY_MS }}>
      // Open Strapi admin in a new tab
      const dataElement = document.querySelector('#redirect-data')
      const strapiUrl =
        dataElement && dataElement.dataset.strapiUrl
          ? dataElement.dataset.strapiUrl
          : ''
      const newWindow = window.open(strapiUrl, '_blank')

      // If popup was blocked, redirect to Strapi admin directly
      if (!newWindow || newWindow.closed || newWindow.closed === undefined) {
        window.location.href = strapiUrl
      } else {
        // Small delay to ensure new tab opens, then redirect current page to homepage
        setTimeout(() => {
          window.location.href = '/'
        }, redirectDelay)
      }
    </script>
  </body>
</html>
