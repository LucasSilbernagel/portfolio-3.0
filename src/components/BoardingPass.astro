---
import { Icon } from 'astro-icon/components'
import PerforationStrip from './PerforationStrip.astro'

export type Props = {
  projectName: string
  completedYear: string
  technologies: string[]
  description: string
  liveUrl?: string
  githubUrl?: string
  imageUrl?: string
  class?: string
}

const {
  projectName,
  completedYear,
  technologies,
  description,
  liveUrl,
  githubUrl,
  imageUrl,
  class: className = '',
} = Astro.props

type ActionLink = {
  href: string
  label: string
  className: string
}

const createLink = (
  href: string | undefined,
  label: string,
  className: string
): ActionLink | null => (href ? { href, label, className } : null)

const actionLinks = [
  createLink(
    liveUrl,
    'Live',
    'rounded bg-terminal-success-green px-2 py-1 text-xs text-white transition-colors hover:bg-green-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600'
  ),
  createLink(
    githubUrl,
    'GitHub',
    'rounded bg-terminal-dark-gray px-2 py-1 text-xs text-white transition-colors hover:bg-gray-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-700'
  ),
].filter((link): link is ActionLink => link !== null)
---

<div class={`boarding-pass ${className} group`}>
  <PerforationStrip />

  <div class="bg-white p-2 md:p-6">
    <div
      class="gap-6 grid grid-cols-1 md:[grid-template-columns:minmax(0,2fr)_minmax(0,1fr)]"
    >
      <div
        class="flex lg:flex-row flex-col items-center lg:items-center gap-6 lg:text-left text-center"
      >
        <div class="md:flex-1 space-y-4 w-full">
          <div>
            <div class="text-gray-500 text-xs uppercase tracking-wide">
              Project
            </div>
            <div class="font-bold text-terminal-dark-gray text-lg">
              {projectName}
            </div>
          </div>
          <div>
            <div class="text-gray-500 text-xs uppercase tracking-wide">
              Completed
            </div>
            <div class="text-gray-700 text-sm">{completedYear}</div>
          </div>
        </div>

        <Icon
          name="mdi:airplane"
          class="flex-shrink-0 w-20 md:w-44 h-20 md:h-44 text-terminal-light-gray"
          aria-hidden="true"
        />

        {
          imageUrl && (
            <div class="md:flex-1 w-full">
              <img
                src={imageUrl}
                alt={projectName}
                class="shadow-md rounded-lg w-full h-32 object-cover"
              />
            </div>
          )
        }
      </div>

      <div class="space-y-4">
        <div>
          <div class="text-gray-500 text-xs uppercase tracking-wide">
            Tech Stack
          </div>
          <div class="flex flex-wrap gap-1 mt-1">
            {
              technologies.map((tech) => (
                <span class="bg-terminal-light-gray px-2 py-1 rounded text-terminal-dark-gray text-xs">
                  {tech}
                </span>
              ))
            }
          </div>
        </div>
        <div>
          <div class="text-gray-500 text-xs uppercase tracking-wide">Links</div>
          <div class="flex gap-2 mt-1">
            {
              actionLinks.map(({ href, label, className: linkClass }) => (
                <a
                  href={href}
                  target="_blank"
                  rel="noopener noreferrer"
                  class={linkClass}
                >
                  {label}
                </a>
              ))
            }
          </div>
        </div>
      </div>
    </div>

    <div class="mt-6 pt-4 border-gray-200 border-t">
      <div class="mb-2 text-gray-500 text-xs uppercase tracking-wide">
        Description
      </div>
      <p class="text-gray-700 text-sm leading-relaxed">{description}</p>
    </div>

    <PerforationStrip />
  </div>
</div>
